<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Eedesiablox</title>
<style>
  body {margin:0;padding:0;font-family:Arial,sans-serif;background:linear-gradient(135deg,red,yellow,orange,green);color:#000;}
  #menu,#game{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;}
  button{margin:5px;padding:8px 12px;font-size:14px;cursor:pointer;border:2px solid #000;background:#fff;border-radius:4px;}
  #chat-container{position:absolute;top:50%;right:10px;transform:translateY(-50%);width:180px;height:auto;display:none;background:#ccc;border:2px solid #000;border-radius:4px;padding:5px;font-size:12px;z-index:999;}
  #chat-messages{height:120px;overflow:auto;margin-bottom:5px;}
  #game-canvas{border:2px solid #000;background:#eef;width:90%;height:50%;margin-top:10px;}
</style>
</head>
<body>

<div id="menu">
  <h1>Eedesiablox</h1>
  <button id="play-btn">Play Obby</button>
  <button id="music-toggle">Toggle Music</button>
  <button id="multiplier-btn">Multiplier: x1</button>
</div>

<div id="game" style="display:none;">
  <canvas id="game-canvas"></canvas>
  <button id="back-btn">Back to Hub</button>
</div>

<div id="chat-container">
  <div id="chat-messages"></div>
  <input id="chat-input" type="text" placeholder="Type...">
</div>

<audio id="bg-music" loop src="winds_of_fjords.mp3"></audio>

<script>
// Elements
const menu=document.getElementById("menu");
const game=document.getElementById("game");
const playBtn=document.getElementById("play-btn");
const backBtn=document.getElementById("back-btn");
const musicBtn=document.getElementById("music-toggle");
const multiplierBtn=document.getElementById("multiplier-btn");
const music=document.getElementById("bg-music");
const chatContainer=document.getElementById("chat-container");
const chatMessages=document.getElementById("chat-messages");
const chatInput=document.getElementById("chat-input");
let multiplier=1;

// Mobile detection
if(/Mobi|Android/i.test(navigator.userAgent)){
  chatContainer.style.display="block";
}

// Chat functions
let chatTimeout;
function showChat(){
  chatContainer.style.display="block";
  if(chatTimeout) clearTimeout(chatTimeout);
  chatTimeout=setTimeout(()=>{chatContainer.style.display="none";},30000);
}
function addChatMessage(msg){
  const div=document.createElement("div");
  div.textContent=msg;
  chatMessages.appendChild(div);
  chatMessages.scrollTop=chatMessages.scrollHeight;
  showChat();
}
chatInput.addEventListener("keydown",e=>{
  if(e.key==="Enter" && chatInput.value.trim()!==""){
    addChatMessage("You: "+chatInput.value);
    chatInput.value="";
  }
});
// Simulated multiplayer messages
setInterval(()=>{
  const fakeUsers=["Alice","Bob","Charlie"];
  addChatMessage(fakeUsers[Math.floor(Math.random()*fakeUsers.length)]+": Hello!");
},15000);

// Menu buttons
playBtn.onclick=()=>{
  menu.style.display="none";
  game.style.display="flex";
  initObby();
};
backBtn.onclick=()=>{
  menu.style.display="flex";
  game.style.display="none";
};
musicBtn.onclick=()=>music.paused?music.play():music.pause();
multiplierBtn.onclick=()=>{
  multiplier=multiplier>=5?1:multiplier+1;
  multiplierBtn.textContent="Multiplier: x"+multiplier;
};

// Simple Obby
const canvas=document.getElementById("game-canvas");
const ctx=canvas.getContext("2d");
let player={x:50,y:200,width:30,height:30,vy:0,jumping:false};
let platforms=[{x:0,y:250,width:300,height:20},{x:350,y:200,width:150,height:20},{x:550,y:150,width:100,height:20}];
let keys={};
function initObby(){
  player.y=200;
  player.vy=0;
  requestAnimationFrame(gameLoop);
}
document.addEventListener("keydown",e=>keys[e.key.toLowerCase()]=true);
document.addEventListener("keyup",e=>keys[e.key.toLowerCase()]=false);
function gameLoop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  // player movement
  if(keys["a"]) player.x-=3;
  if(keys["d"]) player.x+=3;
  if(keys["w"] && !player.jumping){player.vy=-8;player.jumping=true;}
  player.vy+=0.3; player.y+=player.vy;
  // collision
  platforms.forEach(p=>{
    if(player.x< p.x+p.width && player.x+player.width>p.x && player.y< p.y+p.height && player.y+player.height>p.y){
      player.y=p.y-player.height;
      player.vy=0;
      player.jumping=false;
    }
    ctx.fillStyle="#888"; ctx.fillRect(p.x,p.y,p.width,p.height);
  });
  ctx.fillStyle="#f00"; ctx.fillRect(player.x,player.y,player.width,player.height);
  requestAnimationFrame(gameLoop);
}
</script>

</body>
</html>
